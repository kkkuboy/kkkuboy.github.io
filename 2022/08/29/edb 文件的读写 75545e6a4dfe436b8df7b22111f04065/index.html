<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content=".edb æ–‡ä»¶çš„è¯»å†™å…³äº.edbæ–‡ä»¶çš„ç»„ç»‡æ–¹å¼ï¼š 1ã€edbæ–‡ä»¶æ˜¯ä»¥å›¾å±‚çš„å½¢å¼ç»„ç»‡çš„ï¼Œæ¯ä¸ªå›¾å±‚ç”±Pointã€Areaã€Lineä»¥åŠMarkNoteçš„å¯¹è±¡åˆ—è¡¨ç»„æˆï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå›¾å±‚éƒ½å¯ä»¥åŒ…å«è¿™å››ä¸ªéƒ¨åˆ†ï¼ˆä¹Ÿå¯ä»¥åªæ‹¥æœ‰å…¶ä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼‰ï¼Œåˆ†åˆ«è®°å½•çš„è¯¥å›¾å±‚çš„æ‰€æœ‰çš„ç‚¹ã€é¢ã€çº¿ä»¥åŠæ³¨è®°è¦ç´ çš„ä¿¡æ¯ã€‚ 2ã€å¦‚ä¸Šæ‰€è¿°ï¼Œè·å–æ¯ä¸ªå›¾å±‚çš„å››ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥åˆ†åˆ«ä¿®æ”¹ã€èµ‹å€¼ã€‚ 3ã€è·å–å¯¹è±¡åˆ—è¡¨çš„åŸºæœ¬æ­¥éª¤ä¸ºï¼šEPSmapâ†’DataS">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2022/08/29/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content=".edb æ–‡ä»¶çš„è¯»å†™å…³äº.edbæ–‡ä»¶çš„ç»„ç»‡æ–¹å¼ï¼š 1ã€edbæ–‡ä»¶æ˜¯ä»¥å›¾å±‚çš„å½¢å¼ç»„ç»‡çš„ï¼Œæ¯ä¸ªå›¾å±‚ç”±Pointã€Areaã€Lineä»¥åŠMarkNoteçš„å¯¹è±¡åˆ—è¡¨ç»„æˆï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå›¾å±‚éƒ½å¯ä»¥åŒ…å«è¿™å››ä¸ªéƒ¨åˆ†ï¼ˆä¹Ÿå¯ä»¥åªæ‹¥æœ‰å…¶ä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼‰ï¼Œåˆ†åˆ«è®°å½•çš„è¯¥å›¾å±‚çš„æ‰€æœ‰çš„ç‚¹ã€é¢ã€çº¿ä»¥åŠæ³¨è®°è¦ç´ çš„ä¿¡æ¯ã€‚ 2ã€å¦‚ä¸Šæ‰€è¿°ï¼Œè·å–æ¯ä¸ªå›¾å±‚çš„å››ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥åˆ†åˆ«ä¿®æ”¹ã€èµ‹å€¼ã€‚ 3ã€è·å–å¯¹è±¡åˆ—è¡¨çš„åŸºæœ¬æ­¥éª¤ä¸ºï¼šEPSmapâ†’DataS">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%201.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%202.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%203.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%204.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%205.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%206.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%207.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%208.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%209.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2010.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2011.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2012.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2013.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2014.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2015.png">
<meta property="og:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2016.png">
<meta property="article:published_time" content="2022-08-29T09:12:19.986Z">
<meta property="article:modified_time" content="2022-08-29T01:11:24.000Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-edb æ–‡ä»¶çš„è¯»å†™ 75545e6a4dfe436b8df7b22111f04065" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/29/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/" class="article-date">
  <time class="dt-published" datetime="2022-08-29T09:12:19.986Z" itemprop="datePublished">2022-08-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="edb-æ–‡ä»¶çš„è¯»å†™"><a href="#edb-æ–‡ä»¶çš„è¯»å†™" class="headerlink" title=".edb æ–‡ä»¶çš„è¯»å†™"></a>.edb æ–‡ä»¶çš„è¯»å†™</h1><p>å…³äº.edbæ–‡ä»¶çš„ç»„ç»‡æ–¹å¼ï¼š</p>
<p>1ã€edbæ–‡ä»¶æ˜¯ä»¥å›¾å±‚çš„å½¢å¼ç»„ç»‡çš„ï¼Œæ¯ä¸ªå›¾å±‚ç”±Pointã€Areaã€Lineä»¥åŠMarkNoteçš„å¯¹è±¡åˆ—è¡¨ç»„æˆï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå›¾å±‚éƒ½å¯ä»¥åŒ…å«è¿™å››ä¸ªéƒ¨åˆ†ï¼ˆä¹Ÿå¯ä»¥åªæ‹¥æœ‰å…¶ä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼‰ï¼Œåˆ†åˆ«è®°å½•çš„è¯¥å›¾å±‚çš„æ‰€æœ‰çš„ç‚¹ã€é¢ã€çº¿ä»¥åŠæ³¨è®°è¦ç´ çš„ä¿¡æ¯ã€‚</p>
<p>2ã€å¦‚ä¸Šæ‰€è¿°ï¼Œè·å–æ¯ä¸ªå›¾å±‚çš„å››ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥åˆ†åˆ«ä¿®æ”¹ã€èµ‹å€¼ã€‚</p>
<p>3ã€è·å–å¯¹è±¡åˆ—è¡¨çš„åŸºæœ¬æ­¥éª¤ä¸ºï¼šEPSmapâ†’DataSourceâ†’UserLayerListâ†’PointObjListï¼ˆæ­¤æ—¶è·å–ä¸€ä¸ªå›¾å±‚çš„ç‚¹å¯¹è±¡åˆ—è¡¨ï¼‰ï¼Œæ¯ä¸ªå¯¹è±¡åˆ—è¡¨éƒ½æœ‰å¯¹åº”çš„è·å–å‡½æ•°ã€‚</p>
<p>4ã€å½“ç„¶ï¼Œç›´æ¥ä»DataSourceä½¿ç”¨GetObjectListæ–¹æ³•è·å–æ‰€æœ‰å›¾å±‚çš„æ‰€æœ‰å¯¹è±¡ä¹Ÿæ˜¯å…è®¸çš„ã€‚</p>
<h1 id="ä¸€ã€edbæ–‡ä»¶çš„è¯»å†™å’Œä¿®æ”¹ï¼š"><a href="#ä¸€ã€edbæ–‡ä»¶çš„è¯»å†™å’Œä¿®æ”¹ï¼š" class="headerlink" title="ä¸€ã€edbæ–‡ä»¶çš„è¯»å†™å’Œä¿®æ”¹ï¼š"></a>ä¸€ã€edbæ–‡ä»¶çš„è¯»å†™å’Œä¿®æ”¹<strong>ï¼š</strong></h1><p>1ã€edbè¯»å†™çš„å·¥å…·ï¼šæ¸…åå±±ç»´IssGeoBaseç»„ä»¶ï¼ˆcomç»„ä»¶ï¼‰</p>
<p>2ã€éœ€è¦çš„ç¯å¢ƒï¼š1#æ­£ç¡®å®‰è£…æ¸…åå±±ç»´Eps åœ°ç†ä¿¡æ¯å·¥ä½œç«™  2#æ³¨å†Œcomç»„ä»¶ï¼ˆç›®å‰æµ‹è¯•çš„ç»“æœæ˜¯ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶éƒ½è¦æ»¡è¶³ï¼‰</p>
<p>3ã€é¦–å…ˆæ˜¯edbæ–‡ä»¶çš„è¯»å–ï¼Œä¸‹åˆ—ä»£ç å±•ç¤ºäº†å„ä¸ªå›¾å±‚å¯¹è±¡åˆ—è¡¨çš„è¯»å–æ–¹æ³•ï¼Œå…¶ä¸­è¯»å–å›¾å±‚åˆ—è¡¨çš„æ–¹æ³•æœ€ä¸ºé‡è¦ï¼Œåç»­ç‚¹çº¿é¢çš„ä¿®æ”¹è¯»å–éƒ½æ˜¯åœ¨å›¾å±‚ä¸Šä¿®æ”¹çš„<strong>ã€‚</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯»å–</span></span><br><span class="line">IssMapPtr m_EPSmap;</span><br><span class="line">m_EPSmap.<span class="built_in">CreateInstance</span>(CLSID_ssMap);<span class="comment">//åˆ›å»ºEPSæ•°æ®å®ä¾‹</span></span><br><span class="line">m_EPSmap-&gt;<span class="built_in">OpenMap</span>(edbfile);<span class="comment">//edbfileä¸ºedbæ–‡ä»¶çš„BSTRå­—ç¬¦ä¸²ï¼Œå¦‚æœä¸å­˜åœ¨å¯ä»¥ä½¿ç”¨ä¸‹åˆ—ä»£ç è¿›è¡Œåˆ›å»º</span></span><br><span class="line"><span class="comment">//m_EPSmap-&gt;CreateMap(templateFile,edbfile);//templateFileä¸º.mdtæ¨¡æ¿æ–‡ä»¶</span></span><br><span class="line">m_EPSmap-&gt;<span class="built_in">SetDataXParameter</span>(<span class="string">L&quot;DataType&quot;</span>, <span class="string">L&quot;31&quot;</span>);</span><br><span class="line">m_EPSmap-&gt;<span class="built_in">SetDataXParameter</span>(<span class="string">L&quot;AddSystemFieldMode&quot;</span>, <span class="string">L&quot;1&quot;</span>);<span class="comment">//è®¾ç½®æ–‡ä»¶æ¨¡å¼ï¼Œç”±äºæ²¡æœ‰è¯´æ˜æ–‡æ¡£ï¼Œå…·ä½“ä½œç”¨æœªçŸ¥</span></span><br><span class="line">IssDataSourcePtr EPSdatasource;</span><br><span class="line">m_EPSmap-&gt;<span class="built_in">OpenDataSource</span>(edbfile,&amp;EPSdatasource);<span class="comment">//åˆ›å»ºæ•°æ®æº</span></span><br><span class="line">m_EPSmap-&gt;<span class="built_in">cssSetExportAreaMode</span>(<span class="number">2</span>);/è®¾ç½®æ–‡ä»¶æ¨¡å¼ï¼Œç”±äºæ²¡æœ‰è¯´æ˜æ–‡æ¡£ï¼Œå…·ä½“ä½œç”¨æœªçŸ¥</span><br><span class="line">IssUserLayerListPtr EpsLayerList;</span><br><span class="line">EPSdatasource-&gt;<span class="built_in">GetUserLayerList</span>(&amp;EpsLayerList);<span class="comment">//è·å–å›¾å±‚åˆ—è¡¨ï¼Œå°±æ˜¯edbæ–‡ä»¶æ ¼å¼ä¸­çš„å›¾å±‚</span></span><br><span class="line"><span class="comment">//  ä¸Šè¿°ä»£ç ä¸ºè·å–å›¾å±‚åˆ—è¡¨çš„æ–¹æ³•ï¼Œåç»­ç‚¹çº¿é¢çš„ä¿®æ”¹éƒ½åŸºäºè¿™ä¸ªå›¾å±‚åˆ—è¡¨</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">IssUserLayerPtr EPSLayer;</span></span><br><span class="line"><span class="comment">EpsLayerList-&gt;GetAt(i,&amp;EPSLayer);//æ­¤å¤„è·å–å›¾å±‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">LONG dEPSLayerSize;EpsLayerList-&gt;<span class="built_in">GetSize</span>(&amp;dEPSLayerSize);<span class="comment">//è·å–å›¾å±‚åˆ—è¡¨å¤§å°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;dEPSLayerSize; i++)<span class="comment">//è¯¥å¾ªç¯ç”¨äºéå†å›¾å±‚</span></span><br><span class="line">	&#123;</span><br><span class="line">		IssGeObjListPtr pointObjList;<span class="comment">//IssGeObjListPtr å¯¹è±¡å¯ä»¥å­˜å‚¨å›¾å±‚ä¸­çš„ç‚¹ã€çº¿ã€é¢ã€æ³¨è®°å®ä½“</span></span><br><span class="line">		IssGeObjListPtr geObjList;<span class="comment">//</span></span><br><span class="line">		IssGeObjListPtr MarkList;</span><br><span class="line"></span><br><span class="line">		IssUserLayerPtr EPSLayer;</span><br><span class="line">	  EpsLayerList-&gt;<span class="built_in">GetAt</span>(i,&amp;EPSLayer);</span><br><span class="line"></span><br><span class="line">	  EPSLayer-&gt;<span class="built_in">get_LayerName</span>(&amp;layerName);</span><br><span class="line">		EPSLayer-&gt;<span class="built_in">GetPointObjList</span>(&amp;pointObjList);<span class="comment">//è·å–å›¾å±‚çš„ç‚¹åˆ—è¡¨.</span></span><br><span class="line">		<span class="comment">//EPSLayer-&gt;GetAreaObjList(&amp;geObjList);æ¥è·å–é¢çŠ¶å®ä½“åˆ—è¡¨</span></span><br><span class="line">		<span class="comment">//EPSLayer-&gt;GetLineObjList(&amp;geObjList);æ¥è·å–çº¿çŠ¶å®ä½“åˆ—è¡¨</span></span><br><span class="line">		<span class="comment">//EPSLayer-&gt;GetMarkNoteList(&amp;markList);//è·å–å›¾å±‚çš„æ³¨è®°åˆ—è¡¨</span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">			å¦‚æœä½¿ç”¨ä¸‹åˆ—æ–¹å¼è·å–ï¼š</span></span><br><span class="line"><span class="comment">			EPSLayer-&gt;GetObjectListï¼ˆ&amp;geObjListï¼‰</span></span><br><span class="line"><span class="comment">			åˆ™è¯¥geObejListä¸­å«æœ‰Pointã€Areaã€Lineå®ä½“</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">		<span class="comment">//......æ­¤å¤„å¯ä»¥æ·»åŠ å¯¹å›¾å±‚çš„æ“ä½œ</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4ã€edbçš„å†™å…¥ï¼ŒåŸºæœ¬æµç¨‹ä¸ºï¼šåˆ›å»ºæ–°çš„EPSmapå¯¹è±¡â†’æ‰“å¼€OpenDataSourceâ†’æ’å…¥å›¾å±‚â†’å†™å…¥å›¾å±‚æ•°æ®â†’ä¿å­˜æ•°æ®</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å†™å…¥æµç¨‹</span></span><br><span class="line">IssMapPtr o_EPSmap;</span><br><span class="line">o_EPSmap.<span class="built_in">CreateInstance</span>(CLSID_ssMap);<span class="comment">//åˆ›å»ºEPSæ•°æ®å®ä¾‹</span></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">CreateMap</span>(templateFile,edbfile);<span class="comment">//templateFileä¸º.mdtæ¨¡æ¿æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">SetDataXParameter</span>(<span class="string">L&quot;DataType&quot;</span>, <span class="string">L&quot;31&quot;</span>);</span><br><span class="line">o_EPSmap-&gt;<span class="built_in">SetDataXParameter</span>(<span class="string">L&quot;AddSystemFieldMode&quot;</span>, <span class="string">L&quot;1&quot;</span>);<span class="comment">//è®¾ç½®æ–‡ä»¶æ¨¡å¼ï¼Œç”±äºæ²¡æœ‰è¯´æ˜æ–‡æ¡£ï¼Œå…·ä½“ä½œç”¨æœªçŸ¥</span></span><br><span class="line">IssDataSourcePtr EPSdatasource;</span><br><span class="line">o_EPSmap-&gt;<span class="built_in">OpenDataSource</span>(edbfile,&amp;EPSdatasource);<span class="comment">//åˆ›å»ºæ•°æ®æº</span></span><br><span class="line"><span class="comment">//o_EPSmap-&gt;cssSetExportAreaMode(2);</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">		æ­¤å¤„çœç•¥ä»m_EPSmapè¯»å–layerNameã€MarkListç­‰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">InsertBufferLayer</span>(layerName);</span><br><span class="line"><span class="comment">//o_EPSmap-&gt;AppendDataXObject(MarkList);//æ­¤å¤„layerNameã€MarkListç­‰æ¥è‡ªäºäº‹å…ˆè¯»å–çš„m_EPSmapæ¯ä¸ªå›¾å±‚ä¸­çš„å¯¹è±¡åˆ—è¡¨</span></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">AppendDataXObject</span>(geObjList);<span class="comment">//æ­¤å¤„è¿˜æœ‰å¦ä¸€ç§å†™æ³•ï¼š</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	o_EPSmap-&gt;AppendDataXObject(pointObjList)</span></span><br><span class="line"><span class="comment">	o_EPSmap-&gt;AppendDataXObject(lineObjList)</span></span><br><span class="line"><span class="comment">	o_EPSmap-&gt;AppendDataXObject(areaObjList)</span></span><br><span class="line"><span class="comment">	o_EPSmap-&gt;AppendDataXObject(MarkList);</span></span><br><span class="line"><span class="comment">	ä¹Ÿå°±æ˜¯å°†ä¸‰ä¸ªå®ä½“åˆ†å¼€åŠ å…¥ï¼Œå¦‚æœæ‚¨éœ€è¦ä¿®æ”¹æŸä¸ªå®ä½“ï¼Œåº”è¯¥ä½¿ç”¨è¿™ç§å†™æ³•(éœ€è¦ä¿®æ”¹å‡½æ•°ä¼ å…¥å‚æ•°ï¼‰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">SaveBufferData</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//è¯¥æ–¹æ³•åªå†™äº†ä¸€ä¸ªå›¾å±‚ï¼Œå®é™…åº”ç”¨ä¸­ä½¿ç”¨å¾ªç¯å»éå†æ¯ä¸ªå›¾å±‚å³å¯</span></span><br><span class="line"></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">CloseMap</span>();</span><br><span class="line">o_EPSmap.<span class="built_in">Release</span>();</span><br></pre></td></tr></table></figure>

<p>5ã€edbæ–‡ä»¶çš„ä¿®æ”¹ï¼ŒåŸºæœ¬æµç¨‹ä¸ºï¼šåœ¨EPSdatasourceä¸­åˆ é™¤è¢«ä¿®æ”¹çš„è¦ç´ â†’å°†ä¿®æ”¹åçš„è¦ç´ å†™å…¥ã€‚</p>
<h2 id="äºŒã€ä¸‹é¢å°†ä»‹ç»å…³äºç‚¹çš„æ“ä½œï¼š"><a href="#äºŒã€ä¸‹é¢å°†ä»‹ç»å…³äºç‚¹çš„æ“ä½œï¼š" class="headerlink" title="äºŒã€ä¸‹é¢å°†ä»‹ç»å…³äºç‚¹çš„æ“ä½œï¼š"></a>äºŒã€<strong>ä¸‹é¢å°†ä»‹ç»å…³äºç‚¹çš„æ“ä½œï¼š</strong></h2><h3 id="1ã€edbç‚¹åæ ‡çš„è¯»å–ï¼š"><a href="#1ã€edbç‚¹åæ ‡çš„è¯»å–ï¼š" class="headerlink" title="1ã€edbç‚¹åæ ‡çš„è¯»å–ï¼š"></a>1ã€edbç‚¹åæ ‡çš„è¯»å–ï¼š</h3><p>åŸºæœ¬æµç¨‹ä¸ºï¼šè·å–å›¾å±‚â†’pointObjListâ†’è·å–ç‚¹â†’ä¾æ¬¡è¯»å–ç‚¹çš„åæ ‡</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯»å–åæ ‡çš„æ¼”ç¤º</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	åŸºæœ¬æµç¨‹ä¸ºï¼šä»EPSmapè·å–EPSdatasourceï¼Œä»EPSdatasourceè·å–EpsLayerListï¼Œ</span></span><br><span class="line"><span class="comment">	ç„¶åè·å–EpsLayerï¼Œä»EpsLayerè·å–ç‚¹åˆ—è¡¨ï¼Œç„¶åéå†å„ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">long</span> pointObjListSize;</span><br><span class="line">pointObjList-&gt;<span class="built_in">GetSize</span>(&amp;pointObjListSize);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">readPoint3DCoordinate</span><span class="params">(IssGeObjListPtr EpsLayerList)</span><span class="comment">//åæ ‡è¯»å–ä»EpsLayerList å…¥æ‰‹ï¼ŒEpsLayerListä¸ºä»æ•°æ®æºä½¿ç”¨EPSdatasource-&gt;GetUserLayerList(&amp;EpsLayerList)æ–¹æ³•è·å–çš„;</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">ofstream <span class="title">outfile</span><span class="params">(<span class="string">&quot;data.txt&quot;</span>,ios_base::app)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;dEPSLayerSize;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			IssUserLayerPtr EPSLayer;</span><br><span class="line">			BSTR layerName;</span><br><span class="line">			IssGeObjListPtr pointObjList;</span><br><span class="line">			EpsLayerList-&gt;<span class="built_in">GetAt</span>(i,&amp;EPSLayer);<span class="comment">//</span></span><br><span class="line">			EPSLayer-&gt;<span class="built_in">GetPointObjList</span>(&amp;pointObjList);<span class="comment">//æ­¤å¤„è·å–äº†è¯¥å›¾å±‚çš„æ‰€æœ‰ç‚¹</span></span><br><span class="line">			EPSLayer-&gt;<span class="built_in">get_LayerName</span>(&amp;layerName);</span><br><span class="line">			<span class="type">long</span> objSize;</span><br><span class="line">			pointObjList-&gt;<span class="built_in">GetSize</span>(&amp;objSize);<span class="comment">//æ­¤å¤„è·å–äº†è¯¥å›¾å±‚pointçš„ä¸ªæ•°</span></span><br><span class="line">			<span class="type">int</span> count=<span class="number">1</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;objSize;j++)</span><br><span class="line">			&#123;</span><br><span class="line">				</span><br><span class="line">				IssGeoBase * ipObject;</span><br><span class="line">				pointObjList-&gt;<span class="built_in">GetAt</span>(j, &amp;ipObject);<span class="comment">//æ­¤æ—¶å–å‡ºç¬¬jä¸ªç‚¹</span></span><br><span class="line">				IssPoint3DListPtr ipPoints;</span><br><span class="line">				ipObject-&gt;<span class="built_in">GetPointList</span>(&amp;ipPoints);<span class="comment">//æ­¤æ—¶ipPointsåªæœ‰ä¸€ä¸ªç‚¹</span></span><br><span class="line">				IssPoint3DPtr ipPoint;</span><br><span class="line">				ipPoints-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>, &amp;ipPoint );<span class="comment">//é€šè¿‡è¿™ä¸ª	IssPoint3DListPtr ipPoints è·å–äº†ç‚¹</span></span><br><span class="line">				<span class="type">double</span> x,y,z;</span><br><span class="line">	</span><br><span class="line">				ipPoint-&gt;<span class="built_in">get_x</span>(&amp;x);</span><br><span class="line">				ipPoint-&gt;<span class="built_in">get_y</span>(&amp;y);</span><br><span class="line">				ipPoint-&gt;<span class="built_in">get_z</span>(&amp;z);</span><br><span class="line">				outfile&lt;&lt;<span class="string">&quot;layer:&quot;</span>&lt;&lt;<span class="string">&quot;no.&quot;</span>&lt;&lt;i&lt;&lt;layerName&lt;&lt;<span class="string">&quot;point&quot;</span>&lt;&lt;count&lt;&lt;<span class="string">&quot; : &quot;</span>&lt;&lt;<span class="string">&quot;x:&quot;</span>&lt;&lt;x&lt;&lt;<span class="string">&quot;y:&quot;</span>&lt;&lt;y&lt;&lt;<span class="string">&quot;z:&quot;</span>&lt;&lt;z&lt;&lt;endl;</span><br><span class="line">				count++;</span><br><span class="line">				<span class="comment">//å€¼å¾—æ³¨æ„çš„æ˜¯xå’Œyçš„å€¼åº”å½“äº¤æ¢ï¼Œç”¨ä¸Šè¿°æ–¹æ³•è¯»å‡ºçš„xå’Œyå’Œåœ¨å±±ç»´EPSè½¯ä»¶ä¸­æ‰“å¼€çš„xå’Œyæ˜¯ç›¸åçš„ã€‚</span></span><br><span class="line">			&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç å¯¹è‡ªå»ºçš„.edbæ•°æ®çš„è¯»å–ç»“æœå¦‚ä¸‹ï¼š</p>
<p>layer:no.00778999Cpoint1 : x:-25592.9y:51724.9z:0<br>layer:no.00778999Cpoint2 : x:-32806.8y:-70133z:0<br>layer:no.00778999Cpoint3 : x:139549y:-82416.2z:0<br>layer:no.00778999Cpoint4 : x:145398y:48410.3z:0</p>
<p>åœ¨epsè½¯ä»¶ä¸­æŸ¥çœ‹å…¶ä¸­ä¸€ç‚¹åæ ‡ï¼šï¼ˆä¸Šè¿°doubleç±»å‹åœ¨è¾“å‡ºæ—¶åªæ˜¾ç¤ºäº†8ä½ï¼‰,å¯ä»¥çœ‹è§xã€yåæ ‡æ˜¯ç›¸åçš„ã€‚</p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled.png" alt="Untitled"></p>
<h3 id="2ã€edbç‚¹çš„åˆ é™¤ï¼šï¼ˆä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥æ–°æ–‡ä»¶ï¼‰"><a href="#2ã€edbç‚¹çš„åˆ é™¤ï¼šï¼ˆä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥æ–°æ–‡ä»¶ï¼‰" class="headerlink" title="2ã€edbç‚¹çš„åˆ é™¤ï¼šï¼ˆä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥æ–°æ–‡ä»¶ï¼‰"></a>2ã€edbç‚¹çš„åˆ é™¤ï¼šï¼ˆä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥æ–°æ–‡ä»¶ï¼‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//å…³äºç‚¹çš„æ“ä½œ</span></span><br><span class="line"><span class="comment">//ä¸‹åˆ—ä»£ç å°†å›¾å±‚ä¸­çš„ç¬¬ä¸€ä¸ªç‚¹åˆ é™¤ï¼Œç„¶åå†™å…¥è¯¥å›¾å±‚å†™å…¥newedb.edbæ–‡ä»¶</span></span><br><span class="line">IssMapPtr o_EPSmap;</span><br><span class="line">o_EPSmap.<span class="built_in">CreateInstance</span>(CLSID_ssMap);</span><br><span class="line"><span class="function">CString <span class="title">csStr2</span><span class="params">(<span class="string">&quot;newedb.edb&quot;</span>)</span></span>;</span><br><span class="line">BSTR bsName2 = csStr2.<span class="built_in">AllocSysString</span>();</span><br><span class="line"><span class="function">CString <span class="title">tn</span><span class="params">(<span class="string">&quot;testmdt.mdt&quot;</span>)</span></span>;</span><br><span class="line">BSTR tname = tn.<span class="built_in">AllocSysString</span>();</span><br><span class="line">o_EPSmap-&gt;<span class="built_in">CreateMap</span>(tname,bsName2);</span><br><span class="line">o_EPSmap-&gt;<span class="built_in">SetDataXParameter</span>(<span class="string">L&quot;DataType&quot;</span>, <span class="string">L&quot;31&quot;</span>);</span><br><span class="line">o_EPSmap-&gt;<span class="built_in">SetDataXParameter</span>(<span class="string">L&quot;AddSystemFieldMode&quot;</span>, <span class="string">L&quot;1&quot;</span>);<span class="comment">//ä»¥ä¸Šä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ–°æ–‡ä»¶</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   æ­¤å¤„çœç•¥ â€œè·å–å›¾å±‚çš„ç‚¹åˆ—è¡¨â€ çš„ä»£ç </span></span><br><span class="line"><span class="comment">	 å‚ç…§å†™å…¥æµç¨‹è·å–IssGeObjListPtr pointObjList å³å¯</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">InsertBufferLayer</span>(layerName);</span><br><span class="line">pointObjList-&gt;<span class="built_in">RemoveAt</span>(<span class="number">0</span>);<span class="comment">//æ­¤å¤„å°†ç¬¬ä¸€ä¸ªç‚¹åˆ é™¤</span></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">AppendDataXObject</span>(pointObjList);</span><br><span class="line">o_EPSmap-&gt;<span class="built_in">SaveBufferData</span>(<span class="number">0</span>);<span class="comment">//æ­¤æ—¶åˆ é™¤ç¬¬ä¸€ä¸ªç‚¹åçš„å›¾å±‚å·²ç»å†™å…¥newedb.edbæ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<h3 id="3ã€edbç‚¹ä¿®æ”¹ï¼šï¼ˆä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥æ–°æ–‡ä»¶ï¼‰"><a href="#3ã€edbç‚¹ä¿®æ”¹ï¼šï¼ˆä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥æ–°æ–‡ä»¶ï¼‰" class="headerlink" title="3ã€edbç‚¹ä¿®æ”¹ï¼šï¼ˆä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥æ–°æ–‡ä»¶ï¼‰"></a>3ã€edbç‚¹ä¿®æ”¹ï¼šï¼ˆä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥æ–°æ–‡ä»¶ï¼‰</h3><p>åŸºæœ¬æµç¨‹ä¸ºï¼šè·å–å›¾å±‚â†’è·å–å›¾å±‚çš„pointObjListâ†’è·å–ç‚¹â†’ä¿®æ”¹ç‚¹åæ ‡â†’åœ¨pointObjListä¸­åˆ é™¤éœ€è¦ä¿®æ”¹çš„ç‚¹â†’å°†ä¿®æ”¹åçš„ç‚¹åŠ å…¥pointObjListâ†’å†™å…¥edbæ–‡ä»¶</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¿®æ”¹ç‚¹çš„åæ ‡</span></span><br><span class="line"><span class="comment">//åŸºæœ¬æ€è·¯ä¸ºå…ˆè·å–åˆ°ç‚¹ï¼Œç„¶åä½¿ç”¨ç‚¹çš„put_xç­‰æ–¹æ³•ä¿®æ”¹ç‚¹çš„åæ ‡ï¼Œç„¶åå°†ä¿®æ”¹åçš„ç‚¹å†å†™å›å›¾å±‚ä¸­</span></span><br><span class="line"></span><br><span class="line">IssGeoBase * ipObject;</span><br><span class="line">pointObjList-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>, &amp;ipObject);<span class="comment">//æ­¤æ—¶å–å‡ºç¬¬jä¸ªç‚¹</span></span><br><span class="line">IssPoint3DListPtr ipPoints;</span><br><span class="line">ipObject-&gt;<span class="built_in">GetPointList</span>(&amp;ipPoints);<span class="comment">//æ­¤æ—¶ipPointsåªæœ‰ä¸€ä¸ªç‚¹</span></span><br><span class="line">IssPoint3DPtr ipPoint;</span><br><span class="line">ipPoints-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>, &amp;ipPoint );<span class="comment">//é€šè¿‡è¿™ä¸ª	IssPoint3DListPtr ipPoints è·å–äº†ç‚¹</span></span><br><span class="line"><span class="comment">//ä¸Šè¿°ä»£ç å‚ç…§è·å–ç‚¹åæ ‡çš„æ–¹æ³•ï¼Œè·å–åˆ°äº†å›¾å±‚ä¸­ç¬¬ä¸€ä¸ªç‚¹çš„åæ ‡</span></span><br><span class="line"><span class="type">double</span> x=<span class="number">101</span>,y=<span class="number">102</span>,z=<span class="number">103</span>;</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_x</span>(x);</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_y</span>(y);</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_z</span>(z);<span class="comment">//ä¿®æ”¹ç‚¹åæ ‡ä¸º</span></span><br><span class="line"></span><br><span class="line">ipPoints-&gt;<span class="built_in">RemoveAt</span>(<span class="number">0</span>);<span class="comment">//å°†è¯¥ç‚¹åœ¨PointListä¸­åˆ é™¤</span></span><br><span class="line">pointObjList-&gt;<span class="built_in">RemoveAt</span>(<span class="number">0</span>);<span class="comment">//åœ¨å›¾å±‚çš„pointObjListä¸­ä¹Ÿåˆ é™¤è¯¥ç‚¹</span></span><br><span class="line">ipPoints-&gt;<span class="built_in">Add</span>(ipPoint);<span class="comment">//å°†æ–°ç‚¹åœ¨PointListä¸­æ·»åŠ </span></span><br><span class="line"></span><br><span class="line">IssGeoBasePtr newIpObject;</span><br><span class="line">newIpObject.<span class="built_in">CreateInstance</span>( CLSID_ssPointObject );<span class="comment">//åˆ›å»ºä¸€ä¸ªGeoBaseå®ä¾‹ç”¨äºå†™ç‚¹</span></span><br><span class="line">newIpObject-&gt;<span class="built_in">SetPointList</span>(ipPoints,TRUE);</span><br><span class="line">newIpObject-&gt;<span class="built_in">SetColor</span>(<span class="number">255</span>);<span class="comment">//ä¿®æ”¹ç‚¹çš„é¢œè‰²ä¸ºçº¢è‰²</span></span><br><span class="line">pointObjList-&gt;<span class="built_in">Add</span>(newIpObject);<span class="comment">//æ­¤æ—¶pointObjListä¸­çš„ç¬¬ä¸€ä¸ªç‚¹å·²ç»è¢«æ›¿æ¢</span></span><br><span class="line"></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">InsertBufferLayer</span>(layerName);</span><br><span class="line">o_EPSmap-&gt;<span class="built_in">AppendDataXObject</span>(pointObjList);</span><br><span class="line"><span class="comment">//o_EPSmap-&gt;AppendDataXObject(lineObjList);</span></span><br><span class="line"><span class="comment">//â€¦â€¦</span></span><br><span class="line">o_EPSmap-&gt;<span class="built_in">SaveBufferData</span>(<span class="number">0</span>);<span class="comment">//å°†pointObjListå’Œå…¶ä»–ä¿¡æ¯ä¸€èµ·å†™å…¥æ–°æ–‡ä»¶å³å¯</span></span><br></pre></td></tr></table></figure>

<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%201.png" alt="Untitled"></p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%202.png" alt="Untitled"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬ä¸€ä¸ªç‚¹çš„åæ ‡è¢«ä¿®æ”¹ã€‚ä¿®æ”¹åçš„åæ ‡å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%203.png" alt="Untitled"></p>
<h2 id="ä¸‰ã€ä¸‹é¢å°†ä»‹ç»å…³äºçº¿çš„æ“ä½œå’Œä¿®æ”¹åŸæ–‡ä»¶çš„æ–¹æ³•ï¼š"><a href="#ä¸‰ã€ä¸‹é¢å°†ä»‹ç»å…³äºçº¿çš„æ“ä½œå’Œä¿®æ”¹åŸæ–‡ä»¶çš„æ–¹æ³•ï¼š" class="headerlink" title="ä¸‰ã€ä¸‹é¢å°†ä»‹ç»å…³äºçº¿çš„æ“ä½œå’Œä¿®æ”¹åŸæ–‡ä»¶çš„æ–¹æ³•ï¼š"></a>ä¸‰ã€<strong>ä¸‹é¢å°†ä»‹ç»å…³äºçº¿çš„æ“ä½œå’Œä¿®æ”¹åŸæ–‡ä»¶çš„æ–¹æ³•ï¼š</strong></h2><h3 id="1ã€-é¦–å…ˆæ˜¯çº¿çš„ç»„ç»‡å½¢å¼ï¼š"><a href="#1ã€-é¦–å…ˆæ˜¯çº¿çš„ç»„ç»‡å½¢å¼ï¼š" class="headerlink" title="1ã€ é¦–å…ˆæ˜¯çº¿çš„ç»„ç»‡å½¢å¼ï¼š"></a>1ã€ é¦–å…ˆæ˜¯çº¿çš„ç»„ç»‡å½¢å¼ï¼š</h3><p> ï¼ˆ1ï¼‰.edbæ–‡ä»¶ä¸­çš„çº¿ç”±ç‚¹ç»„æˆï¼Œç”±ç‚¹ä¾æ¬¡é“¾æ¥è€Œæˆ</p>
<p> ï¼ˆ2ï¼‰.æ‰€æœ‰çš„çº¿éƒ½ï¼ˆå¯ä»¥ï¼‰æ‹¥æœ‰è‡ªå·±çš„å±æ€§ï¼Œå¦‚ï¼šï¼ˆå…¶ä¸­æœ‰äº›å±æ€§å¯ä»¥ç¼ºå¤±ï¼Œå¦‚ï¼šç”¨æˆ·æ ‡è¯†ï¼‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å…¶ä¸­N&#x3D;7ä¸ºè¯¥çº¿åŒ…å«çš„ç‚¹çš„ä¸ªæ•°ï¼Œ4ä¸ºç¬¬å››ä¸ªç‚¹ï¼Œæ­¤å¤„æ˜¾ç¤ºç¬¬4ä¸ªç‚¹çš„åæ ‡.</p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%204.png" alt="Untitled"></p>
<pre><code>  ï¼ˆ3ï¼‰.ç‰¹åˆ«çš„ï¼šç±»ä¼¼äºè¿æˆå°é—­å›¾å½¢çš„æƒ…å†µï¼š
</code></pre>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%205.png" alt="Untitled"></p>
<pre><code>     åªéœ€è¦æä¾›ä¸€ä¸ªé‡å¤çš„ç‚¹å³å¯ï¼Œä¸‹é¢ä¸ºè¯¥çº¿è¦ç´ çš„å±æ€§è¡¨ï¼Œæ‚¨å¯ä»¥å‘ç°ç¬¬4ä¸ªç‚¹å’Œç¬¬7ä¸ªç‚¹åæ ‡ç›¸åŒï¼š
</code></pre>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%206.png" alt="Untitled"></p>
<h3 id="2ã€çº¿åæ ‡çš„è¯»å–ï¼Œçº¿åæ ‡çš„è¯»å–ä¸»è¦æ˜¯é€šè¿‡è¯»å–å…¶ä¸­ç‚¹çš„åæ ‡æ¥å®ç°çš„ï¼š"><a href="#2ã€çº¿åæ ‡çš„è¯»å–ï¼Œçº¿åæ ‡çš„è¯»å–ä¸»è¦æ˜¯é€šè¿‡è¯»å–å…¶ä¸­ç‚¹çš„åæ ‡æ¥å®ç°çš„ï¼š" class="headerlink" title="2ã€çº¿åæ ‡çš„è¯»å–ï¼Œçº¿åæ ‡çš„è¯»å–ä¸»è¦æ˜¯é€šè¿‡è¯»å–å…¶ä¸­ç‚¹çš„åæ ‡æ¥å®ç°çš„ï¼š"></a>2ã€çº¿åæ ‡çš„è¯»å–ï¼Œçº¿åæ ‡çš„è¯»å–ä¸»è¦æ˜¯é€šè¿‡è¯»å–å…¶ä¸­ç‚¹çš„åæ ‡æ¥å®ç°çš„ï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	é¦–å…ˆæ˜¯è·å–åˆ°ä¸€ä¸ªå›¾å±‚ï¼ˆè¯¦è§æ–‡æ¡£å¼€å¤´ï¼‰ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ï¼Œä¸‹åˆ—EPSLayerä¸ºå›¾å±‚ï¼Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">ofstream <span class="title">outfile</span><span class="params">(<span class="string">&quot;data.txt&quot;</span>,ios_base::app)</span></span>;<span class="comment">//ç”¨æ¥å†™åæ ‡çš„txtæ–‡ä»¶</span></span><br><span class="line">IssGeObjListPtr lineObjList;</span><br><span class="line">EPSLayer-&gt;<span class="built_in">GetLineObjList</span>(&amp;lineObjList);<span class="comment">//å’Œç‚¹ä¸€æ ·ï¼Œè·å–å›¾å±‚çš„lineåˆ—è¡¨</span></span><br><span class="line">IssGeoBase * lineObject;</span><br><span class="line">lineObjList-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>,&amp;lineObject);<span class="comment">//è·å–lineåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ï¼ˆ0ï¼‰ä¸ªlineå¯¹è±¡lineObject</span></span><br><span class="line"><span class="comment">//long tp;</span></span><br><span class="line"><span class="comment">//lineObject-&gt;GetGroupID(&amp;tp);è·å–çº¿çš„GroupID å…¶ä»–å±æ€§è·å–æ–¹æ³•ç›¸åŒ</span></span><br><span class="line">IssPoint3DListPtr ipPoints;</span><br><span class="line">lineObject-&gt;<span class="built_in">GetPointList</span>(&amp;ipPoints);<span class="comment">//æ­¤å¤„è·å–è¯¥çº¿çš„pointåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­ç‚¹çš„é¡ºåºå‰æ–‡å·²è§£é‡Š</span></span><br><span class="line"><span class="type">long</span> size;</span><br><span class="line">ipPoints-&gt;<span class="built_in">GetSize</span>(&amp;size);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span> ;i&lt;size;i++)<span class="comment">//è¯¥å¾ªç¯éå†äº†æ‰€æœ‰çš„ç‚¹</span></span><br><span class="line">&#123;</span><br><span class="line">	IssPoint3DPtr ipPoint;</span><br><span class="line">	ipPoints-&gt;<span class="built_in">GetAt</span>(i, &amp;ipPoint );<span class="comment">//å–åˆ°è¯¥ç‚¹ï¼Œä¾æ¬¡è¯»å–åæ ‡ã€‚</span></span><br><span class="line">	<span class="type">double</span> x,y,z;</span><br><span class="line"></span><br><span class="line">	ipPoint-&gt;<span class="built_in">get_x</span>(&amp;x);</span><br><span class="line">	ipPoint-&gt;<span class="built_in">get_y</span>(&amp;y);</span><br><span class="line">	ipPoint-&gt;<span class="built_in">get_z</span>(&amp;z);</span><br><span class="line"></span><br><span class="line">	outfile&lt;&lt;<span class="string">&quot;point:&quot;</span>&lt;&lt;<span class="string">&quot;no.&quot;</span>&lt;&lt;i&lt;&lt;<span class="string">&quot; : &quot;</span>&lt;&lt;<span class="string">&quot;x:&quot;</span>&lt;&lt;x&lt;&lt;<span class="string">&quot;y:&quot;</span>&lt;&lt;y&lt;&lt;<span class="string">&quot;z:&quot;</span>&lt;&lt;z&lt;&lt;endl;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢å±•ç¤ºäº†ä¸€ä¸ªçº¿è¦ç´ çš„è¯»å–ç»“æœï¼šğŸš¨åŒæ ·çš„ xã€yç»“æœç›¸å</p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%207.png" alt="Untitled"></p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%208.png" alt="Untitled"></p>
<h3 id="3ã€çº¿åæ ‡çš„ä¿®æ”¹-ï¼Œä¸‹åˆ—ç¤ºä¾‹ä»£ç åŒæ—¶ä¹Ÿå±•ç¤ºäº†å¦‚ä½•ä¿®æ”¹åŸæ–‡ä»¶ï¼š"><a href="#3ã€çº¿åæ ‡çš„ä¿®æ”¹-ï¼Œä¸‹åˆ—ç¤ºä¾‹ä»£ç åŒæ—¶ä¹Ÿå±•ç¤ºäº†å¦‚ä½•ä¿®æ”¹åŸæ–‡ä»¶ï¼š" class="headerlink" title="3ã€çº¿åæ ‡çš„ä¿®æ”¹ ï¼Œä¸‹åˆ—ç¤ºä¾‹ä»£ç åŒæ—¶ä¹Ÿå±•ç¤ºäº†å¦‚ä½•ä¿®æ”¹åŸæ–‡ä»¶ï¼š"></a>3ã€çº¿åæ ‡çš„ä¿®æ”¹ ï¼Œä¸‹åˆ—ç¤ºä¾‹ä»£ç åŒæ—¶ä¹Ÿå±•ç¤ºäº†å¦‚ä½•ä¿®æ”¹åŸæ–‡ä»¶ï¼š</h3><p>ï¼ˆ1ï¼‰é¦–å…ˆæ˜¯åŸºæœ¬æ€è·¯ï¼šè·å–éœ€è¦ä¿®æ”¹çš„lineObjâ†’å°†EPSdatasourceä¸­è¯¥å¯¹è±¡åˆ é™¤â†’ä¿®æ”¹lineObjâ†’å°†lineObjå†™å›</p>
<p>ï¼ˆ2ï¼‰ä¹Ÿå°±æ˜¯è¯´ä¿®æ”¹åŸæ–‡ä»¶çš„æ€è·¯å°±æ˜¯ï¼šåˆ é™¤è¢«ä¿®æ”¹çš„è¦ç´ â†’æ·»åŠ ä¿®æ”¹åçš„è¦ç´ ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ­¤å¤„ä»£ç ä¸ºlineåæ ‡ä¿®æ”¹ä»£ç çš„ä¸€éƒ¨åˆ†ï¼Œç”¨ä»¥è¯´æ˜å¦‚ä½•ä¿®æ”¹åŸæ–‡ä»¶</span></span><br><span class="line"><span class="comment">//â€¦â€¦â€¦â€¦</span></span><br><span class="line">lineObject-&gt;<span class="built_in">GetID</span>(&amp;id);<span class="comment">//è·å–éœ€è¦ä¿®æ”¹çš„è¦ç´ çš„id</span></span><br><span class="line">EPSdatasource-&gt;<span class="built_in">DeleteObject</span>(id)<span class="comment">//æ­¤å¤„æŒ‰ç…§idåˆ é™¤è¢«ä¿®æ”¹çš„è¦ç´ </span></span><br><span class="line"><span class="comment">//â€¦â€¦â€¦â€¦</span></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> maxId;</span><br><span class="line">EPSdatasource-&gt;<span class="built_in">GetMaxObjID</span>(&amp;maxId);</span><br><span class="line">areaObject-&gt;<span class="built_in">SetID</span>(maxId+<span class="number">1</span>);<span class="comment">//ç»è¿‡æµ‹è¯•å‘ç°ï¼ŒEPSä¸å…è®¸å‡ºç°é‡å¤çš„idå±æ€§ï¼Œå³ä½¿æ”¹æŒæœ‰è¯¥idçš„è¦ç´ å·²ç»è¢«åˆ é™¤</span></span><br><span class="line">EPSdatasource-&gt;<span class="built_in">AddObject</span>(lineObject);<span class="comment">//å°†ä¿®æ”¹åçš„è¦ç´ æ·»åŠ å›å»</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰ä¸‹åˆ—ä»£ç å†æºæ–‡ä»¶ä¸­ä¿®æ”¹äº†lineçš„åæ ‡ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">é¦–å…ˆæ˜¯è·å–åˆ°ä¸€ä¸ªå›¾å±‚ï¼ˆè¯¦è§æ–‡æ¡£å¼€å¤´ï¼‰ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ï¼Œä¸‹åˆ—EPSLayerä¸ºå›¾å±‚ï¼Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">IssGeObjListPtr lineObjList;</span><br><span class="line">EPSLayer-&gt;<span class="built_in">GetLineObjList</span>(&amp;lineObjList);</span><br><span class="line">EPSLayer-&gt;<span class="built_in">get_LayerName</span>(&amp;layerName);</span><br><span class="line"></span><br><span class="line">IssGeoBase * lineObject;</span><br><span class="line">lineObjList-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>,&amp;lineObject);<span class="comment">//è¿™é‡Œå›¾å±‚ä¸­åªç”¨ä¸€æ¡çº¿</span></span><br><span class="line"><span class="type">long</span> id;</span><br><span class="line">lineObject-&gt;<span class="built_in">GetID</span>(&amp;id);<span class="comment">//æ‰¾åˆ°äº†è¿™æ¡çº¿çš„id</span></span><br><span class="line">EPSdatasource-&gt;<span class="built_in">DeleteObject</span>(id);<span class="comment">//åˆ é™¤äº†è¿™æ¡çº¿ï¼Œç¨‹åºè¿è¡Œåˆ°æ­¤ï¼ŒåŸæ–‡ä»¶ä¸­çš„çº¿å·²ç»è¢«åˆ é™¤äº†</span></span><br><span class="line"></span><br><span class="line">IssPoint3DListPtr ipPoints;</span><br><span class="line">lineObject-&gt;<span class="built_in">GetPointList</span>(&amp;ipPoints);<span class="comment">//å–å‡ºäº†lineä¸­æ‰€æœ‰çš„ç‚¹ï¼Œä¿å­˜åœ¨ipPointsä¸­</span></span><br><span class="line"></span><br><span class="line">IssPoint3DPtr ipPoint;</span><br><span class="line">ipPoints-&gt;<span class="built_in">GetAt</span>(<span class="number">2</span>, &amp;ipPoint );<span class="comment">//æ­¤æ—¶å–å‡ºäº†éœ€è¦ä¿®æ”¹çš„ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> x=<span class="number">101</span>,y=<span class="number">102</span>,z=<span class="number">103</span>;</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_x</span>(x);</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_y</span>(y);</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_z</span>(z);<span class="comment">//ä¿®æ”¹ç‚¹çš„åæ ‡</span></span><br><span class="line"><span class="comment">//                                          æ­¤å¤„ä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªç‚¹å†setå›å»ä¹Ÿå¯ä»¥</span></span><br><span class="line">ipPoints-&gt;<span class="built_in">SetAt</span>(<span class="number">2</span>,ipPoint);<span class="comment">//å°†ç‚¹å†™å›å»</span></span><br><span class="line">lineObject-&gt;<span class="built_in">SetPointList</span>(ipPoints,TRUE);<span class="comment">//å°†pointåˆ—è¡¨å†™å…¥lineä¸­ï¼Œæ­¤æ—¶lineå·²ç»ä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line">lineObjList-&gt;<span class="built_in">SetAt</span>(<span class="number">0</span>,lineObject);</span><br><span class="line">EPSdatasource-&gt;<span class="built_in">AddObjectList</span>(lineObjList);</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰ä¸‹é¢ä¸ºç¤ºä¾‹ä»£ç çš„æ•ˆæœæ¼”ç¤ºï¼š(å›¾ä¸­ç”±ä¸¤ä¸ªå›¾å±‚ï¼ŒDEFAULTå›¾å±‚ä¸­æœ‰å››ä¸ªç‚¹ã€ä¸€æ¡çº¿ï¼‰ï¼Œä¿®æ”¹åè¿˜æ˜¯å››ä¸ªç‚¹ã€ä¸€æ¡çº¿ï¼ˆå®ç°äº†å¯¹åŸæ–‡ä»¶çš„ä¿®æ”¹ï¼‰ï¼š</p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%209.png" alt="Untitled"></p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2010.png" alt="Untitled"></p>
<h2 id="å››ã€ä¸‹é¢å°†ä»‹ç»å…³äºé¢çš„æ“ä½œï¼š"><a href="#å››ã€ä¸‹é¢å°†ä»‹ç»å…³äºé¢çš„æ“ä½œï¼š" class="headerlink" title="å››ã€ä¸‹é¢å°†ä»‹ç»å…³äºé¢çš„æ“ä½œï¼š"></a>å››ã€<strong>ä¸‹é¢å°†ä»‹ç»å…³äºé¢çš„æ“ä½œï¼š</strong></h2><h3 id="1ã€-é¦–å…ˆæ˜¯é¢çš„ç»„ç»‡å½¢å¼ï¼š"><a href="#1ã€-é¦–å…ˆæ˜¯é¢çš„ç»„ç»‡å½¢å¼ï¼š" class="headerlink" title="1ã€ é¦–å…ˆæ˜¯é¢çš„ç»„ç»‡å½¢å¼ï¼š"></a>1ã€ é¦–å…ˆæ˜¯é¢çš„ç»„ç»‡å½¢å¼ï¼š</h3><p>é¢çš„ç»„ç»‡å½¢å¼å’Œçº¿ç±»ä¼¼ï¼Œç”±ç‚¹ç»„æˆï¼ŒæŒ‰é¡ºåºé“¾æ¥ç‚¹ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªç‚¹å’Œæœ€åä¸€ç‚¹è¿æ¥ï¼Œæ‰€è°“å…¶æ“ä½œæ–¹å¼å’Œçº¿çš„æ“ä½œæ–¹å¼å‡ ä¹ç›¸åŒã€‚ä¸€ä¸ªé¢å¯ä»¥æ‹¥æœ‰ä»¥ä¸‹å±æ€§:</p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2011.png" alt="Untitled"></p>
<h3 id="2ã€é¢åæ ‡çš„è¯»å–ï¼Œå’Œçº¿åæ ‡è¯»å–æ–¹æ³•ç›¸åŒï¼Œåªä¿®æ”¹äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è·å–é¢è¦ç´ è€Œä¸æ˜¯çº¿è¦ç´ ï¼š"><a href="#2ã€é¢åæ ‡çš„è¯»å–ï¼Œå’Œçº¿åæ ‡è¯»å–æ–¹æ³•ç›¸åŒï¼Œåªä¿®æ”¹äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è·å–é¢è¦ç´ è€Œä¸æ˜¯çº¿è¦ç´ ï¼š" class="headerlink" title="2ã€é¢åæ ‡çš„è¯»å–ï¼Œå’Œçº¿åæ ‡è¯»å–æ–¹æ³•ç›¸åŒï¼Œåªä¿®æ”¹äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è·å–é¢è¦ç´ è€Œä¸æ˜¯çº¿è¦ç´ ï¼š"></a>2ã€é¢åæ ‡çš„è¯»å–ï¼Œå’Œçº¿åæ ‡è¯»å–æ–¹æ³•ç›¸åŒï¼Œåªä¿®æ”¹äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è·å–é¢è¦ç´ è€Œä¸æ˜¯çº¿è¦ç´ ï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	é¦–å…ˆæ˜¯è·å–åˆ°ä¸€ä¸ªå›¾å±‚ï¼ˆè¯¦è§æ–‡æ¡£å¼€å¤´ï¼‰ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ï¼Œä¸‹åˆ—EPSLayerä¸ºå›¾å±‚ï¼Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">IssGeObjListPtr areaObjList;</span><br><span class="line">EPSLayer-&gt;<span class="built_in">GetAreaObjList</span>(&amp;areaObjList);<span class="comment">//å’Œç‚¹ä¸€æ ·ï¼Œè·å–å›¾å±‚çš„areaåˆ—è¡¨</span></span><br><span class="line">IssGeoBase * areaObject;</span><br><span class="line">areaObjList-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>,&amp;areaObject);<span class="comment">//è·å–areaåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ï¼ˆ0ï¼‰ä¸ªareaå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">IssPoint3DListPtr ipPoints;</span><br><span class="line">areaObject-&gt;<span class="built_in">GetPointList</span>(&amp;ipPoints);<span class="comment">//æ­¤å¤„è·å–è¯¥çº¿çš„pointåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­ç‚¹çš„é¡ºåºå‰æ–‡å·²è§£é‡Š</span></span><br><span class="line"><span class="type">long</span> size;</span><br><span class="line">ipPoints-&gt;<span class="built_in">GetSize</span>(&amp;size);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span> ;i&lt;size;i++)<span class="comment">//è¯¥å¾ªç¯éå†äº†æ‰€æœ‰çš„ç‚¹</span></span><br><span class="line">&#123;</span><br><span class="line">	IssPoint3DPtr ipPoint;</span><br><span class="line">	ipPoints-&gt;<span class="built_in">GetAt</span>(i, &amp;ipPoint );<span class="comment">//å–åˆ°è¯¥ç‚¹ï¼Œä¾æ¬¡è¯»å–åæ ‡ã€‚</span></span><br><span class="line">	<span class="type">double</span> x,y,z;</span><br><span class="line"></span><br><span class="line">	ipPoint-&gt;<span class="built_in">get_x</span>(&amp;x);</span><br><span class="line">	ipPoint-&gt;<span class="built_in">get_y</span>(&amp;y);</span><br><span class="line">	ipPoint-&gt;<span class="built_in">get_z</span>(&amp;z);</span><br><span class="line"></span><br><span class="line">	outfile&lt;&lt;<span class="string">&quot;point:&quot;</span>&lt;&lt;<span class="string">&quot;no.&quot;</span>&lt;&lt;i&lt;&lt;<span class="string">&quot; : &quot;</span>&lt;&lt;<span class="string">&quot;x:&quot;</span>&lt;&lt;x&lt;&lt;<span class="string">&quot;y:&quot;</span>&lt;&lt;y&lt;&lt;<span class="string">&quot;z:&quot;</span>&lt;&lt;z&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3ã€é¢åæ ‡çš„ä¿®æ”¹ï¼Œå’Œé¢åæ ‡è¯»å–æ–¹æ³•ç›¸åŒï¼Œåªä¿®æ”¹äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è·å–é¢è¦ç´ è€Œä¸æ˜¯çº¿è¦ç´ ï¼š"><a href="#3ã€é¢åæ ‡çš„ä¿®æ”¹ï¼Œå’Œé¢åæ ‡è¯»å–æ–¹æ³•ç›¸åŒï¼Œåªä¿®æ”¹äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è·å–é¢è¦ç´ è€Œä¸æ˜¯çº¿è¦ç´ ï¼š" class="headerlink" title="3ã€é¢åæ ‡çš„ä¿®æ”¹ï¼Œå’Œé¢åæ ‡è¯»å–æ–¹æ³•ç›¸åŒï¼Œåªä¿®æ”¹äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è·å–é¢è¦ç´ è€Œä¸æ˜¯çº¿è¦ç´ ï¼š"></a>3ã€é¢åæ ‡çš„ä¿®æ”¹ï¼Œå’Œé¢åæ ‡è¯»å–æ–¹æ³•ç›¸åŒï¼Œåªä¿®æ”¹äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è·å–é¢è¦ç´ è€Œä¸æ˜¯çº¿è¦ç´ ï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> é¦–å…ˆæ˜¯è·å–åˆ°ä¸€ä¸ªå›¾å±‚ï¼ˆè¯¦è§æ–‡æ¡£å¼€å¤´ï¼‰ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ï¼Œä¸‹åˆ—EPSLayerä¸ºå›¾å±‚ï¼Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">IssGeObjListPtr areaObjList;</span><br><span class="line">EPSLayer-&gt;<span class="built_in">GetAreaObjList</span>(&amp;areaObjList);</span><br><span class="line">EPSLayer-&gt;<span class="built_in">get_LayerName</span>(&amp;layerName);</span><br><span class="line"></span><br><span class="line">IssGeoBase * areaObject;</span><br><span class="line">areaObjList-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>,&amp;areaObject);<span class="comment">//è¿™é‡Œå›¾å±‚ä¸­åªç”¨ä¸€ä¸ªé¢</span></span><br><span class="line"><span class="type">long</span> id;</span><br><span class="line">areaObject-&gt;<span class="built_in">GetID</span>(&amp;id);<span class="comment">//æ‰¾åˆ°äº†è¿™ä¸ªé¢çš„id</span></span><br><span class="line">outfile&lt;&lt;id;</span><br><span class="line">EPSdatasource-&gt;<span class="built_in">DeleteObject</span>(id);<span class="comment">//åˆ é™¤äº†è¿™ä¸ªé¢</span></span><br><span class="line"></span><br><span class="line">IssPoint3DListPtr ipPoints;</span><br><span class="line">areaObject-&gt;<span class="built_in">GetPointList</span>(&amp;ipPoints);<span class="comment">//å–å‡ºäº†areaï¼ˆé¢ï¼‰ä¸­æ‰€æœ‰çš„ç‚¹ï¼Œä¿å­˜åœ¨ipPointsä¸­</span></span><br><span class="line"></span><br><span class="line">IssPoint3DPtr ipPoint;</span><br><span class="line">ipPoints-&gt;<span class="built_in">GetAt</span>(<span class="number">2</span>, &amp;ipPoint );<span class="comment">//æ­¤æ—¶å–å‡ºäº†éœ€è¦ä¿®æ”¹çš„ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> x=<span class="number">101</span>,y=<span class="number">102</span>,z=<span class="number">103</span>;</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_x</span>(x);</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_y</span>(y);</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_z</span>(z);<span class="comment">//ä¿®æ”¹ç‚¹çš„åæ ‡</span></span><br><span class="line"><span class="comment">//                                          æ­¤å¤„ä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªç‚¹å†setå›å»ä¹Ÿå¯ä»¥</span></span><br><span class="line">ipPoints-&gt;<span class="built_in">SetAt</span>(<span class="number">2</span>,ipPoint);<span class="comment">//å°†ç‚¹å†™å›pointåˆ—è¡¨</span></span><br><span class="line">areaObject-&gt;<span class="built_in">SetPointList</span>(ipPoints,TRUE);<span class="comment">//å°†pointåˆ—è¡¨å†™å…¥é¢</span></span><br><span class="line"></span><br><span class="line">areaObjList-&gt;<span class="built_in">SetAt</span>(<span class="number">0</span>,areaObject);</span><br><span class="line">EPSdatasource-&gt;<span class="built_in">AddObjectList</span>(areaObjList);</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢ä¸ºç¤ºä¾‹ä»£ç çš„æ•ˆæœæ¼”ç¤ºï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¿®æ”¹äº†åŸæ–‡ä»¶ï¼š</p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2012.png" alt="Untitled"></p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2013.png" alt="Untitled"></p>
<h2 id="äº”ã€ä¸‹é¢å°†ä»‹ç»å…³äºæ³¨è®°çš„æ“ä½œï¼š"><a href="#äº”ã€ä¸‹é¢å°†ä»‹ç»å…³äºæ³¨è®°çš„æ“ä½œï¼š" class="headerlink" title="äº”ã€ä¸‹é¢å°†ä»‹ç»å…³äºæ³¨è®°çš„æ“ä½œï¼š"></a>äº”ã€<strong>ä¸‹é¢å°†ä»‹ç»å…³äºæ³¨è®°çš„æ“ä½œï¼š</strong></h2><h3 id="1ã€-é¦–å…ˆæ˜¯æ³¨è®°çš„ç»„ç»‡å½¢å¼ï¼š"><a href="#1ã€-é¦–å…ˆæ˜¯æ³¨è®°çš„ç»„ç»‡å½¢å¼ï¼š" class="headerlink" title="1ã€ é¦–å…ˆæ˜¯æ³¨è®°çš„ç»„ç»‡å½¢å¼ï¼š"></a>1ã€ é¦–å…ˆæ˜¯æ³¨è®°çš„ç»„ç»‡å½¢å¼ï¼š</h3><p>ä¸é¢ç›¸ä¼¼ï¼Œä½†åªæœ‰ä¸€ä¸ªç‚¹ç»„æˆï¼Œå¯ä»¥ä½¿ç”¨ä¿®æ”¹é¢åæ ‡çš„æ–¹æ³•æ¥ä¿®æ”¹æ³¨è®°çš„åæ ‡ï¼Œåªéœ€è¦æŠŠç›¸å…³å‡½æ•°æŒ‡å‘æ³¨è®°å³å¯ï¼Œä½†æ˜¯æ³¨è®°å†…å®¹ç›¸å…³çš„å±æ€§ä¸Šè¿°æ–¹æ³•è®¿é—®ä¸åˆ°ã€‚åŒæ—¶é™„ä¸Šæ³¨è®°çš„å±æ€§è¡¨ï¼š</p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2014.png" alt="Untitled"></p>
<h3 id="3ã€æ³¨è®°ä½ç½®å’Œæ³¨è®°å†…å®¹çš„ä¿®æ”¹æ–¹å¼ï¼š"><a href="#3ã€æ³¨è®°ä½ç½®å’Œæ³¨è®°å†…å®¹çš„ä¿®æ”¹æ–¹å¼ï¼š" class="headerlink" title="3ã€æ³¨è®°ä½ç½®å’Œæ³¨è®°å†…å®¹çš„ä¿®æ”¹æ–¹å¼ï¼š"></a>3ã€æ³¨è®°ä½ç½®å’Œæ³¨è®°å†…å®¹çš„ä¿®æ”¹æ–¹å¼ï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">IssGeObjListPtr markList;</span><br><span class="line">EPSLayer-&gt;<span class="built_in">GetMarkNoteList</span>(&amp;markList);</span><br><span class="line">EPSLayer-&gt;<span class="built_in">get_LayerName</span>(&amp;layerName);</span><br><span class="line"></span><br><span class="line">IssGeoBase* mark;</span><br><span class="line">markList-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>,&amp;mark);</span><br><span class="line">IssMarkNotePtr markNote;</span><br><span class="line">markNote=mark;<span class="comment">//ä¸é¢çš„è¯»å–ä»…æœ‰æ­¤å¤„ä¸åŒï¼Œæ­¤å¤„å°†markä¼ é€’ç»™markNoteï¼Œåé¢å¯¹ç€markNoteæ“ä½œå³å¯ï¼ŒmarkNoteæ‹¥æœ‰markçš„å±æ€§ï¼Œå¹¶å…è®¸æˆ‘ä»¬è®¿é—®æ³¨è®°å†…å®¹åŠç›¸å…³å±æ€§</span></span><br><span class="line"><span class="type">long</span> id;</span><br><span class="line">markNote-&gt;<span class="built_in">GetID</span>(&amp;id);</span><br><span class="line">EPSdatasource-&gt;<span class="built_in">DeleteObject</span>(id);</span><br><span class="line"></span><br><span class="line">IssPoint3DListPtr ipPoints;</span><br><span class="line">markNote-&gt;<span class="built_in">GetPointList</span>(&amp;ipPoints);</span><br><span class="line"></span><br><span class="line">IssPoint3DPtr ipPoint;</span><br><span class="line">ipPoints-&gt;<span class="built_in">GetAt</span>(<span class="number">0</span>, &amp;ipPoint );<span class="comment">//æ³¨è®°åªæœ‰ä¸€ä¸ªç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> x=<span class="number">111</span>,y=<span class="number">112</span>,z=<span class="number">113</span>;</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_x</span>(x);</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_y</span>(y);</span><br><span class="line">ipPoint-&gt;<span class="built_in">put_z</span>(z);</span><br><span class="line">                                 </span><br><span class="line">ipPoints-&gt;<span class="built_in">SetAt</span>(<span class="number">0</span>,ipPoint);</span><br><span class="line">markNote-&gt;<span class="built_in">SetPointList</span>(ipPoints,TRUE);</span><br><span class="line"></span><br><span class="line">markNote-&gt;<span class="built_in">SetStringText</span>(<span class="string">L&quot;å—äº¬&quot;</span>);<span class="comment">//ä¿®æ”¹æ³¨è®°æ–‡å­—ä¸ºâ€œå—äº¬â€</span></span><br><span class="line">markNote-&gt;<span class="built_in">SetColor</span>(<span class="number">255</span>);<span class="comment">//ä¿®æ”¹æ³¨è®°é¢œè‰²ä¸ºçº¢è‰²</span></span><br><span class="line"></span><br><span class="line">markList-&gt;<span class="built_in">SetAt</span>(<span class="number">0</span>,markNote);</span><br><span class="line">EPSdatasource-&gt;<span class="built_in">AddObjectList</span>(markList);</span><br></pre></td></tr></table></figure>

<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2015.png" alt="Untitled"></p>
<p><img src="/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/Untitled%2016.png" alt="Untitled"></p>
<h2 id="å…­ã€EDBæ–‡ä»¶è¯»å†™æ€»ç»“ï¼š"><a href="#å…­ã€EDBæ–‡ä»¶è¯»å†™æ€»ç»“ï¼š" class="headerlink" title="å…­ã€EDBæ–‡ä»¶è¯»å†™æ€»ç»“ï¼š"></a>å…­ã€EDBæ–‡ä»¶è¯»å†™æ€»ç»“ï¼š</h2><p>ç‚¹çº¿é¢ä»¥åŠæ³¨è®°çš„ä¿®æ”¹æ–¹å¼éƒ½å¯ä»¥æ¦‚æ‹¬ä¸ºï¼šè·å–layerâ†’è·å–å¯¹åº”çš„objListâ†’è·å–objâ†’ä¿®æ”¹objå±æ€§â†’æ›¿æ¢åŸæ¥çš„obj</p>
<p>æ–°å†™å…¥çš„objçš„idå±æ€§ä¸èƒ½å’Œä¹‹å‰idé‡å¤ï¼Œå³ä½¿è¯¥idå¯¹åº”çš„objå¾ˆæ—©ä¹‹å‰å°±å·²ç»è¢«åˆ é™¤ï¼ˆå³ä½¿æ˜¯é€šè¿‡EPSè½¯ä»¶æ“ä½œè¯¥æ–‡ä»¶æ—¶ä½¿ç”¨è¿‡çš„idå€¼éƒ½ä¸å¯ä»¥ï¼‰ã€‚ä½¿ç”¨Microsoft OfficeÂ Access æ‰“å¼€edbæ–‡ä»¶å‘ç°æ— è®ºæ˜¯ä½¿ç”¨EPSè½¯ä»¶åˆ é™¤ã€è¿˜æ˜¯è‡ªå·±ç¼–å†™çš„ç¨‹åºåˆ é™¤çš„è¦ç´ åœ¨æ•°æ®åº“ä¸­ä»»ç„¶å­˜åœ¨ï¼Œä½†æ˜¯ä½¿ç”¨EPSè½¯ä»¶æ‰“å¼€ï¼Œè¢«åˆ é™¤çš„è¦ç´ ä¸å¯è§ã€‚</p>
<h2 id="ä¸ƒã€å‡½æ•°å°è£…"><a href="#ä¸ƒã€å‡½æ•°å°è£…" class="headerlink" title="ä¸ƒã€å‡½æ•°å°è£…"></a>ä¸ƒã€å‡½æ•°å°è£…</h2><p><a href="edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/dataOperation.cpp">dataOperation.cpp</a></p>
<p><a href="edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/edb.zip">edb.zip</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetLayerListFromDataSource</span><span class="params">(IssMapPtr&amp; m_EPSmap, IssDataSourcePtr&amp; EPSdatasource, IssUserLayerListPtr&amp; EpsLayerList, BSTR edbFilePath)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//æ‰“å¼€æ•°æ®æº,è·å¾—å›¾å±‚åˆ—è¡¨</span></span><br><span class="line">	m_EPSmap.<span class="built_in">CreateInstance</span>(CLSID_ssMap);</span><br><span class="line"></span><br><span class="line">	m_EPSmap-&gt;<span class="built_in">OpenMap</span>(edbFilePath);</span><br><span class="line">	m_EPSmap-&gt;<span class="built_in">SetDataXParameter</span>(<span class="string">L&quot;DataType&quot;</span>, <span class="string">L&quot;31&quot;</span>);</span><br><span class="line">	m_EPSmap-&gt;<span class="built_in">SetDataXParameter</span>(<span class="string">L&quot;AddSystemFieldMode&quot;</span>, <span class="string">L&quot;1&quot;</span>);</span><br><span class="line"></span><br><span class="line">	m_EPSmap-&gt;<span class="built_in">OpenDataSource</span>(edbFilePath, &amp;EPSdatasource);</span><br><span class="line">	m_EPSmap-&gt;<span class="built_in">cssSetExportAreaMode</span>(<span class="number">2</span>);</span><br><span class="line">	EPSdatasource-&gt;<span class="built_in">GetUserLayerList</span>(&amp;EpsLayerList);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">GetGeObjListFromLayer</span><span class="params">(IssUserLayerPtr&amp; EPSLayer, IssGeObjListPtr&amp; GeObjList, LONG GeObjectType)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//ä»å›¾å±‚è·å–è¦ç´ é›†</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (GeObjectType == <span class="number">0</span>) &#123; EPSLayer-&gt;<span class="built_in">GetPointObjList</span>(&amp;GeObjList); &#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GeObjectType == <span class="number">1</span>) &#123; EPSLayer-&gt;<span class="built_in">GetLineObjList</span>(&amp;GeObjList); &#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GeObjectType == <span class="number">2</span>) &#123; EPSLayer-&gt;<span class="built_in">GetAreaObjList</span>(&amp;GeObjList); &#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GeObjectType == <span class="number">3</span>) &#123; EPSLayer-&gt;<span class="built_in">GetMarkNoteList</span>(&amp;GeObjList); &#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">GetCPointCoordinateFromObj</span><span class="params">(IssGeoBasePtr  GeObject, LONG CPointIndex, <span class="type">double</span>&amp; x, <span class="type">double</span>&amp; y, <span class="type">double</span>&amp; z)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//è·å–ç»„æˆè¦ç´ çš„ç‚¹çš„ä¸‰çº¬åæ ‡</span></span><br><span class="line">	IssPoint3DListPtr _CPoints;</span><br><span class="line">	GeObject-&gt;<span class="built_in">GetPointList</span>(&amp;_CPoints);<span class="comment">//è¿™é‡Œæ˜¯å–åˆ°çš„ç»„æˆè¦ç´ çš„ç‚¹åˆ—è¡¨</span></span><br><span class="line">	IssPoint3DPtr _CPoint;</span><br><span class="line">	<span class="type">long</span> _size;</span><br><span class="line">	_CPoints-&gt;<span class="built_in">GetSize</span>(&amp;_size);</span><br><span class="line">	<span class="keyword">if</span> (CPointIndex &lt; _size) &#123; _CPoints-&gt;<span class="built_in">GetAt</span>(CPointIndex, &amp;_CPoint); &#125;<span class="comment">//å–åˆ°äº†éœ€è¦è¯»å–çš„CPoint</span></span><br><span class="line">	<span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">	_CPoint-&gt;<span class="built_in">get_x</span>(&amp;x);</span><br><span class="line">	_CPoint-&gt;<span class="built_in">get_y</span>(&amp;y);</span><br><span class="line">	_CPoint-&gt;<span class="built_in">get_z</span>(&amp;z);</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">SetCPointToObj</span><span class="params">(IssGeoBasePtr  GeObject, IssGeObjListPtr&amp; GeObjList, LONG ObjIndexinList, LONG CPointIndex, <span class="type">double</span> x, <span class="type">double</span> y, <span class="type">double</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//ä¿®æ”¹è¦ç´ åæ ‡</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	long id;</span></span><br><span class="line"><span class="comment">	GeObject-&gt;GetID(&amp;id);</span></span><br><span class="line"><span class="comment">	EPSdatasource-&gt;DeleteObject(id);è¿™ä¸‰è¡Œå¯ä»¥åŠ ä¸Šä¹Ÿå¯ä»¥ï¼Œå¯¹å®é™…ç»“æœæ²¡æœ‰å½±å“</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	IssPoint3DListPtr _CPoints;</span><br><span class="line">	GeObject-&gt;<span class="built_in">GetPointList</span>(&amp;_CPoints);<span class="comment">//è¿™é‡Œæ˜¯å–åˆ°çš„ç»„æˆè¦ç´ çš„ç‚¹åˆ—è¡¨</span></span><br><span class="line">	IssPoint3DPtr _CPoint;</span><br><span class="line"></span><br><span class="line">	<span class="type">long</span> _CPointsSize;</span><br><span class="line">	_CPoints-&gt;<span class="built_in">GetSize</span>(&amp;_CPointsSize);</span><br><span class="line">	<span class="keyword">if</span> (CPointIndex &lt; _CPointsSize) &#123; _CPoints-&gt;<span class="built_in">GetAt</span>(CPointIndex, &amp;_CPoint); &#125;<span class="comment">//å–åˆ°äº†éœ€è¦ä¿®æ”¹çš„CPoint</span></span><br><span class="line">	<span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line"></span><br><span class="line">	_CPoint-&gt;<span class="built_in">put_x</span>(x);</span><br><span class="line">	_CPoint-&gt;<span class="built_in">put_y</span>(y);</span><br><span class="line">	_CPoint-&gt;<span class="built_in">put_z</span>(z);</span><br><span class="line"></span><br><span class="line">	_CPoints-&gt;<span class="built_in">SetAt</span>(CPointIndex, _CPoint);<span class="comment">//ä¿®æ”¹å®Œåæ ‡ï¼Œå†™å›ç»„æˆè¦ç´ çš„ç‚¹åˆ—è¡¨</span></span><br><span class="line">	GeObject-&gt;<span class="built_in">SetPointList</span>(_CPoints, <span class="literal">true</span>);<span class="comment">//å°†ä¿®æ”¹åçš„è¦ç´ çš„ç‚¹åˆ—è¡¨èµ‹ç»™è¦ç´ </span></span><br><span class="line"></span><br><span class="line">	<span class="type">long</span> _ObjIndexinListSize;</span><br><span class="line">	GeObjList-&gt;<span class="built_in">GetSize</span>(&amp;_ObjIndexinListSize);</span><br><span class="line">	<span class="keyword">if</span> (ObjIndexinList &lt; _ObjIndexinListSize) &#123; GeObjList-&gt;<span class="built_in">SetAt</span>(ObjIndexinList, GeObject); &#125;<span class="comment">//è¿™é‡Œæ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯æŠŠè¦ç´ å†™å›å¯¹åº”çš„è¦ç´ åˆ—è¡¨ï¼Œåº”ä¸ºåªæœ‰é€šè¿‡è¦ç´ åˆ—è¡¨æ‰èƒ½å‘åŸæ•°æ®æ­£ç¡®å†™å…¥è¦ç´ ï¼Œå¦åˆ™ä¼šå‡ºç°idé‡å¤çš„é—®é¢˜</span></span><br><span class="line">	<span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹åˆ—ç¤ºä¾‹ä»£ç ä½¿ç”¨ä¸Šè¿°å‡½æ•°å®ç°äº†å®æµ‹æ•°æ®çš„ä¿®æ”¹ï¼šæ‰€æœ‰è¦ç´ xã€yå¹³ç§»100ç±³ï¼Œzè®¾ä¸º121</span></span><br><span class="line"><span class="comment">//æµç¨‹ä¸ºï¼š</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	1ã€æ‰“å¼€æ•°æ®æºï¼Œè·å–å›¾å±‚åˆ—è¡¨</span></span><br><span class="line"><span class="comment">	2ã€ä¾æ¬¡è®¿é—®å›¾å±‚åˆ—è¡¨ä¸­çš„å„ä¸ªå›¾å±‚</span></span><br><span class="line"><span class="comment">	3ã€ä¾æ¬¡è·å–å›¾å±‚ä¸­çš„è¦ç´ åˆ—è¡¨</span></span><br><span class="line"><span class="comment">	4ã€ä¾æ¬¡å–å‡ºè¦ç´ åˆ—è¡¨ä¸­çš„å„ä¸ªè¦ç´ ï¼Œå¹¶ä¿®æ”¹ï¼Œä¿®æ”¹åå†™å›è¦ç´ åˆ—è¡¨</span></span><br><span class="line"><span class="comment">	5ã€å°†è¦ç´ åˆ—è¡¨å†™å›åŸæ•°æ®</span></span><br><span class="line"><span class="comment">	ï¼ˆæ³¨ï¼šè¦ç´ åæ ‡çš„ä¿®æ”¹æ˜¯é€šè¿‡è¦ç´ åˆ—è¡¨çš„ä¿®æ”¹å®ç°çš„ï¼Œä¸Šè¿°æµç¨‹ç®€å•æ¥è¯´å°±æ˜¯ï¼š</span></span><br><span class="line"><span class="comment">		è·å–è¦ç´ åˆ—è¡¨ï¼ˆä»å›¾å±‚ï¼‰-&gt;ä¿®æ”¹è¦ç´ åˆ—è¡¨ï¼ˆé€šè¿‡ä¿®æ”¹å…¶ä¸­çš„è¦ç´ ï¼‰-&gt;å°†è¦ç´ åˆ—è¡¨å†™å›ï¼ˆå†™å›ä¸éœ€è¦å†™å›å›¾å±‚äº†ï¼Œè¦ç´ å¸¦æœ‰å›¾å±‚å±æ€§ï¼Œç›´æ¥å†™å›æ•°æ®æºå°±å¥½ï¼‰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">IssMapPtr m_EPSmap;</span></span><br><span class="line"><span class="comment">CString csStr(&quot;æ­¦ç©´æµ…åŒºå›¾20200310.edb&quot;)//è¿™é‡ŒæŒ‡å‘æ•°æ®è·¯å¾„;</span></span><br><span class="line"><span class="comment">BSTR bsName = csStr.AllocSysString();</span></span><br><span class="line"><span class="comment">IssDataSourcePtr EPSdatasource;</span></span><br><span class="line"><span class="comment">IssUserLayerListPtr EpsLayerList;</span></span><br><span class="line"><span class="comment">IssUserLayerPtr EPSLayer;</span></span><br><span class="line"><span class="comment">IssGeObjListPtr ObjList;</span></span><br><span class="line"><span class="comment">IssGeoBasePtr Object;</span></span><br><span class="line"><span class="comment">long layerSize;</span></span><br><span class="line"><span class="comment">//ä¸Šé¢å£°æ˜äº†éœ€è¦ç”¨åˆ°çš„æ‰€æœ‰è¦ç”¨åˆ°çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ï¼šEPSdatasourceï¼ˆæ•°æ®æºï¼‰ã€EpsLayerListï¼ˆå›¾å±‚åˆ—è¡¨ï¼‰ã€EPSlayerï¼ˆå›¾å±‚ï¼‰ã€ObjListï¼ˆè¦ç´ åˆ—è¡¨ï¼‰ã€Objectï¼ˆè¦ç´ ï¼‰</span></span><br><span class="line"><span class="comment">GetLayerListFromDataSource(m_EPSmap, EPSdatasource, EpsLayerList, bsName);//è·å–äº†å›¾å±‚åˆ—è¡¨ã€‚</span></span><br><span class="line"><span class="comment">EpsLayerList-&gt;GetSize(&amp;layerSize);//è·å–å›¾å±‚ä¸ªæ•°</span></span><br><span class="line"><span class="comment">for (long i = 0; i &lt; layerSize; i++)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">	EpsLayerList-&gt;GetAt(i, &amp;EPSLayer);//æ­¤å¤„è·å–äº†ä¸€ä¸ªå›¾å±‚</span></span><br><span class="line"><span class="comment">	for (long j = 0; j &lt; 4; j++)//å››ç§è¦ç´ ç‚¹ã€çº¿ã€é¢ã€æ³¨è®°åˆ†åˆ«å¯¹åº”0ã€1ã€2ã€3</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		GetGeObjListFromLayer(EPSLayer, ObjList, j);//è·å–äº†è¦ç´ åˆ—è¡¨ï¼Œå¦‚æœj=0å°±æ˜¯ç‚¹åˆ—è¡¨ï¼Œä¾æ¬¡ç±»æ¨</span></span><br><span class="line"><span class="comment">		long objListSize;//è¿™ä¸ªå‚æ•°ä¸ºè¯¥å›¾å±‚è¯¥ç±»è¦ç´ çš„ä¸ªæ•°ï¼Œå¦‚æœå¦‚æœj=0å°±æ˜¯è¿™ä¸ªå›¾å±‚é‡Œé¢æ‰€æœ‰çš„ç‚¹ï¼Œä¾æ¬¡ç±»æ¨</span></span><br><span class="line"><span class="comment">		ObjList-&gt;GetSize(&amp;objListSize);</span></span><br><span class="line"><span class="comment">		if (objListSize != 0)//å¦‚æœè¿™ä¸ªå›¾å±‚æœ‰å¯¹åº”è¦ç´ æ‰è¿›è¡Œä¿®æ”¹</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			for (long k = 0; k &lt; objListSize; k++)//éå†æ¯ä¸ªè¦ç´ </span></span><br><span class="line"><span class="comment">			&#123;</span></span><br><span class="line"><span class="comment">				ObjList-&gt;GetAt(k, &amp;Object);//å–åˆ°äº†å›¾å±‚è¦ç´ åˆ—è¡¨ä¸­çš„ç¬¬kä¸ªè¦ç´ ï¼ˆç‚¹ã€çº¿ã€é¢ã€æ³¨è®°ï¼‰</span></span><br><span class="line"><span class="comment">				long CPointSize;</span></span><br><span class="line"><span class="comment">				Object-&gt;GetPointSize(&amp;CPointSize);//ç»„æˆè¿™ä¸ªè¦ç´ çš„ç‚¹çš„ä¸ªæ•°ï¼ˆCPointçš„ä¸ªæ•°ï¼‰ï¼Œç‚¹å’Œæ³¨è®°å°±åªæœ‰ä¸€ä¸ªç‚¹ï¼Œçº¿å’Œé¢ä¸ºè‹¥å¹²ä¸ª</span></span><br><span class="line"><span class="comment">				for (long m = 0; m &lt; CPointSize; m++)</span></span><br><span class="line"><span class="comment">				&#123;</span></span><br><span class="line"><span class="comment">					double x, y, z;</span></span><br><span class="line"><span class="comment">					GetCPointCoordinateFromObj(Object, m, x, y, z);//è·å–è¿™ä¸ªCPointçš„ä¸‰ç»´åæ ‡</span></span><br><span class="line"><span class="comment">					SetCPointToObj(Object, ObjList, k, m, x + 100, y + 100, 121);//ä¿®æ”¹è¿™ä¸ªCPointçš„ä¸‰ç»´åæ ‡</span></span><br><span class="line"><span class="comment">				&#125;</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">			EPSdatasource-&gt;AddObjectList(ObjList);//ä¸Šè¿°æµç¨‹éƒ½æ˜¯åœ¨getåˆ°çš„å„ä¸ªè¦ç´ ä¸­æ”¹å†™ï¼Œå¹¶æ²¡æœ‰ä¿®æ”¹åŸæ–‡ä»¶ï¼Œè¿™ä¸€æ­¥æŠŠä¿®æ”¹åçš„è¦ç´ åˆ—è¡¨å†™å›åŸæ–‡ä»¶ï¼ˆæ­¤æ—¶åŸæ–‡ä»¶å·²ç»è¢«ä¿®æ”¹ï¼‰</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		else</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			continue;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">m_EPSmap-&gt;OpenMap(bsName);</span></span><br><span class="line"><span class="comment">m_EPSmap-&gt;CloseMap();</span></span><br><span class="line"><span class="comment">EPSdatasource-&gt;CloseDatabase();//ç»è¿‡æµ‹è¯•ï¼Œæ­¤æ—¶é¢å¤–äº§ç”Ÿçš„ä¸‰ä¸ªæ–‡ä»¶å·²ç»è¢«åˆ é™¤ï¼Œæ–‡ä»¶å¯ä»¥æ­£å¸¸è®¿é—®ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>æ§ä»¶æ›´æ–°åå¯ä»¥ä½¿ç”¨updateæ–¹æ³•ï¼š</p>
<p><a href="edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/dataOperationNew.cpp">dataOperationNew.cpp</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">IssMapPtr <span class="title">ipMap</span><span class="params">(CLSID_ssMap)</span></span>;</span><br><span class="line">BSTR bstrPath=<span class="string">L&quot;&quot;</span>;<span class="comment">//edbæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">HRESULT hr = ipMap-&gt;<span class="built_in">OpenMap</span>(bstrPath);</span><br><span class="line"><span class="keyword">if</span> (hr != S_OK)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è·å–æ‰€æœ‰å¯¹è±¡</span></span><br><span class="line">IssGeObjListPtr ipGeoList;</span><br><span class="line">ipMap-&gt;<span class="built_in">GetGeObjList</span>(<span class="string">L&quot;&quot;</span>, &amp;ipGeoList);<span class="comment">//æ­¤å¤„ä¸ºæ–°å¢çš„æ–¹æ³•ï¼Œä¹‹å‰éœ€è¦ä»dataBaseè·å–</span></span><br><span class="line"><span class="comment">//æ­¤å¤„L&quot;&quot;ä¸ºï¼šBSTR codeAndLayersï¼Œæ ¹æ®codeå’Œå›¾å±‚æ¥è·å–è¦ç´ ï¼Œè¿™é‡Œä¸ºç©ºæ—¶è·å–æ‰€æœ‰çš„è¦ç´ </span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//ä¿®æ”¹åæ ‡</span></span><br><span class="line"><span class="type">long</span> geoCount;</span><br><span class="line">ipGeoList-&gt;<span class="built_in">GetSize</span>(&amp;geoCount);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; geoCount; i++)</span><br><span class="line">&#123;</span><br><span class="line">	IssGeoBasePtr ipGeo;</span><br><span class="line">	ipGeoList-&gt;<span class="built_in">GetAt</span>(i, &amp;ipGeo);<span class="comment">//è·å–åˆ°è¦ç´ </span></span><br><span class="line">	IssPoint3DListPtr ipPs;</span><br><span class="line">	ipGeo-&gt;<span class="built_in">GetPointList</span>(&amp;ipPs);<span class="comment">//è·å–åˆ°ç»„æˆè¦ç´ çš„ç‚¹é›†</span></span><br><span class="line">	<span class="type">long</span> pCount;</span><br><span class="line">	ipPs-&gt;<span class="built_in">GetSize</span>(&amp;pCount);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; pCount; j++)<span class="comment">//éå†ç‚¹é›†</span></span><br><span class="line">	&#123;</span><br><span class="line">		IssPoint3DPtr ipPoint;</span><br><span class="line">		ipPs-&gt;<span class="built_in">GetAt</span>(j, &amp;ipPoint);</span><br><span class="line">		<span class="type">double</span> x, y, z;</span><br><span class="line">		ipPoint-&gt;<span class="built_in">get_x</span>(&amp;x);</span><br><span class="line">		ipPoint-&gt;<span class="built_in">get_y</span>(&amp;y);</span><br><span class="line">		<span class="comment">//ipPoint-&gt;get_z(&amp;z);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//ä¿®æ”¹åæ ‡</span></span><br><span class="line">		x += <span class="number">100</span>;</span><br><span class="line">		y += <span class="number">100</span>;</span><br><span class="line">		z += <span class="number">100</span>;<span class="comment">//å¦‚æœzåæ ‡ä¸éœ€è¦ä¿®æ”¹ç›´æ¥æ³¨é‡Šæ‰å°±å¥½</span></span><br><span class="line">		ipPoint-&gt;<span class="built_in">put_x</span>(x);</span><br><span class="line">		ipPoint-&gt;<span class="built_in">put_y</span>(y);</span><br><span class="line">		ipPoint-&gt;<span class="built_in">put_z</span>(z);</span><br><span class="line">		ipPs-&gt;<span class="built_in">SetAt</span>(j, ipPoint);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">long</span> geoID;</span><br><span class="line">	ipGeo-&gt;<span class="built_in">GetID</span>(&amp;geoID);</span><br><span class="line">	ipMap-&gt;<span class="built_in">UpdateObjectPoints</span>(geoID, ipPs);<span class="comment">//æ ¹æ®idä¿®æ”¹è¦ç´ å±æ€§</span></span><br><span class="line">	ipPs.<span class="built_in">Release</span>();</span><br><span class="line">	ipGeo.<span class="built_in">Release</span>();</span><br><span class="line">&#125;</span><br><span class="line">ipGeoList-&gt;<span class="built_in">RemoveAll</span>();</span><br><span class="line">ipGeoList.<span class="built_in">Release</span>();</span><br><span class="line">ipMap-&gt;<span class="built_in">CloseMap</span>();</span><br><span class="line">ipMap.<span class="built_in">Release</span>();</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/08/29/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/" data-id="cl7ejll6q0000bkwm6sji9cim" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2022/08/29/%E5%9F%BA%E4%BA%8E%E5%AF%86%E9%92%A5%E7%9A%84%E5%B5%8C%E5%85%A5%E5%92%8C%E6%A8%A1%E6%9D%BF%E5%8C%B9%E9%85%8D%E7%9A%84%E6%8F%90%E5%8F%96%208b79a39fca6540169ceeb01d8d18a5c9/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/08/29/edb%20%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%86%99%2075545e6a4dfe436b8df7b22111f04065/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/29/%E5%9F%BA%E4%BA%8E%E5%AF%86%E9%92%A5%E7%9A%84%E5%B5%8C%E5%85%A5%E5%92%8C%E6%A8%A1%E6%9D%BF%E5%8C%B9%E9%85%8D%E7%9A%84%E6%8F%90%E5%8F%96%208b79a39fca6540169ceeb01d8d18a5c9/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/29/ssss/">ssss</a>
          </li>
        
          <li>
            <a href="/2022/08/29/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>